!function(){var e={menu:document.createElement("div"),limit:document.createElement("input"),gap:document.createElement("input"),sag:document.createElement("input"),fov:document.createElement("input"),flo:document.createElement("input"),off:document.createElement("input"),non:document.createElement("input"),end:document.createElement("input"),tgl:document.createElement("input"),cssStatic:document.createElement("style"),cssDynamic:document.createElement("style"),orientation:{yaw:0,pitch:0,roll:0},mouseMove:function(t){e.orientation.yaw=180*-Math.cos(Math.PI*t.clientX/innerWidth)*e.limit.value,e.orientation.pitch=180*Math.cos(Math.PI*t.clientY/innerHeight)*e.limit.value,e.updateBody()},gyroMove:function(t){innerWidth>innerHeight?(e.orientation.yaw=-(t.alpha+t.beta),e.orientation.pitch=t.gamma-90*Math.sign(90-Math.abs(t.beta))):(e.orientation.yaw=-(t.alpha+t.gamma),e.orientation.pitch=t.beta-90),e.updateBody()},updateOrigin:function(e){document.body.style.transformOrigin=innerWidth/2+pageXOffset+"px "+(innerHeight/2+pageYOffset)+"px"},updateBody:function(){document.body.style.transform="perspective("+Math.pow(2,e.fov.value)+"px) translateZ(-"+e.gap.value+"px) rotateX("+e.orientation.pitch+"deg) rotateY("+e.orientation.yaw+"deg)"},updateCSS:function(){if(e.non.checked)e.cssDynamic.innerHTML="";else if(e.off.checked)e.cssDynamic.innerHTML="* { transform-style: preserve-3d; }";else{for(var t=0;document.querySelector("body"+" > *".repeat(t));t++);var n=e.gap.value/t,o=-Math.PI*e.sag.value/t;e.cssDynamic.innerHTML=`\n* {\n\ttransform: translateZ(${n}px) rotateX(${o}rad);\n\ttransform-style: preserve-3d;\n\ttransition: transform 1s;\n\toutline: 1px solid rgba(0, 0, 0, 0.0625);\n\t${e.flo.checked?"overflow: visible !important;":""}\n}\n*:hover {\n\ttransform: translateZ(${2*n}px) rotateX(${2*o}rad);\n\t${e.flo.checked?"":"overflow: visible;"}\n}\n`}},toggle:function(){"active"==e.menu.className?e.menu.removeAttribute("class"):e.menu.className="active"},quit:function(){window.removeEventListener("deviceorientation",e.gyroMove),window.removeEventListener("mousemove",e.mouseMove),window.removeEventListener("scroll",e.updateOrigin),window.addEventListener("resize",e.updateOrigin),e.menu.remove(),e.cssStatic.remove(),e.cssDynamic.remove(),document.body.removeAttribute("style")},newRange:function(t,n,o,i,a,r,d){e.menu.appendChild(t),t.type="range",t.min=o,t.max=a,t.step=i,t.value=r,t.addEventListener("input",d),e.menu.appendChild(document.createElement("span")).innerHTML=n,e.menu.appendChild(document.createElement("br"))},newCheckbox:function(t,n,o){e.menu.appendChild(t),t.type="checkbox",t.addEventListener("click",o),e.menu.appendChild(document.createElement("span")).innerHTML=n,e.menu.appendChild(document.createElement("br"))},newButton:function(t,n,o){e.menu.appendChild(t),t.type="button",t.value=n,t.addEventListener("click",o)},init:function(){document.body.parentNode.appendChild(e.menu).id="tri-menu",e.newRange(e.limit,"limit",0,.03125,1,.125,e.updateBody),e.newRange(e.gap,"gap / distance",0,32,512,128,(function(){e.updateCSS(),e.updateBody()})),e.newRange(e.sag,"sag",-.25,.03125,.25,0,e.updateCSS),e.newRange(e.fov,"field of view",7,1,13,10,e.updateBody),e.newCheckbox(e.flo,"force overflow",e.updateCSS),e.flo.setAttribute("checked",""),e.newCheckbox(e.off,"flatten layers",e.updateCSS),e.newCheckbox(e.non,"flatten everything",e.updateCSS),e.newButton(e.end,"Quit",e.quit),e.newButton(e.tgl,"â‰¡",e.toggle),e.tgl.id="tri-toggle",e.menu.appendChild(e.cssStatic).innerHTML="\nhtml, body {\n\ttransition-property: none;\n\theight: 100%;\n\twidth: 100%;\n}\nhtml, html:hover, #tri-menu, #tri-menu > *, #tri-menu > *:hover {\n\ttransform: none;\n\toutline: none;\n\toverflow: auto !important;\n\tfloat: none;\n}\n#tri-menu {\n\tposition: fixed;\n\ttop: 0;\n\tleft: 0;\n\tbackground: rgba(0, 0, 0, 0.5);\n\tcolor: white;\n\tborder: 1px solid rgba(255, 255, 255, 0.5);;\n\tborder-radius: 0 0 16px 0;\n\tpadding: 8px;\n\ttransform: translate(-100%, -100%) translate(32px, 32px);\n}\n#tri-menu.active {\n\ttransform: none;\n}\n#tri-toggle {\n\tposition: absolute;\n\tbottom: 0;\n\tright: 0;\n\theight: 32px;\n\twidth: 32px;\n\tbackground: transparent;\n\tcolor: white;\n\tborder: none;\n\tcursor: pointer;\n}\n#tri-menu.active > #tri-toggle {\n\tbackground: white;\n\tcolor: black;\n\tborder-radius: 8px 0 0 0;\n}\n",e.menu.appendChild(e.cssDynamic),e.updateCSS(),window.addEventListener("deviceorientation",e.gyroMove),window.addEventListener("mousemove",e.mouseMove),window.addEventListener("scroll",e.updateOrigin),window.addEventListener("resize",e.updateOrigin),window.scrollBy(0,1)}};e.init()}();
